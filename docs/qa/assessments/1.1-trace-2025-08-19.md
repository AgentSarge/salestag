# Requirements Traceability Matrix

## Story: 1.1 — Audio VOX MVP

### Coverage Summary

- Total Requirements (ACs): 5
- Fully Covered: 0 (0%)
- Partially Covered: 5 (100%)
- Not Covered: 0 (0%)

Planning reference: qa.qaLocation/assessments/1.1-test-design-2025-08-19.md

### Requirement Mappings

#### AC1: VOX starts with sustained level and includes pre‑roll

Coverage: PARTIAL

Given-When-Then:

- Unit Test (planned):
  - Given: VOX configured with start threshold/hold and pre‑roll buffer
  - When: Simulated RMS > start threshold for hold duration
  - Then: VOX transitions Armed→Pre‑Roll→Recording and pre‑roll buffer is queued
- Integration Test (planned):
  - Given: Pre‑roll ring buffer and WAV writer
  - When: VOX triggers start
  - Then: WAV contains pre‑roll samples preceding trigger
- E2E Test (planned):
  - Given: On-device tone burst > threshold for > hold ms
  - When: Playback through speaker near device
  - Then: Resulting file includes pre‑roll prior to tone onset

#### AC2: VOX stops after sustained silence and includes post‑roll

Coverage: PARTIAL

- Unit Test (planned): Given silence < stop threshold for hold ms, When VOX monitors level, Then state moves Recording→Post‑Roll→Armed and post‑roll buffer appended
- Integration Test (planned): Given WAV writer in recording, When post‑roll appended, Then file tails with post‑roll samples
- E2E Test (planned): Given speech then silence, When recording ends, Then file ends shortly after silence (> post‑roll)

#### AC3: Free space guardrail prevents start

Coverage: PARTIAL

- Unit Test (planned): Given free space below threshold, When VOX would trigger, Then start is blocked and reason logged
- Integration Test (planned): Given storage manager reports low space, When start requested, Then state remains Armed and LED error pattern set

#### AC4: LED patterns reflect states

Coverage: PARTIAL

- Unit Test (planned): Given VOX state transitions, When UI controller updates, Then LED maps to armed/recording/error patterns

#### AC5: Manual override resumes arming after stop

Coverage: PARTIAL

- Integration Test (planned): Given manual start session active, When VOX trigger occurs, Then VOX ignored; After manual stop, VOX re‑arms

### Critical Gaps

- No automated tests implemented yet; all coverage is planning-level
- E2E validation depends on on-bench audio playback and measurement

### Recommendations

1. Implement unit tests for VOX state machine and storage guardrail first (P0)
2. Implement integration tests for pre/post roll with WAV writer (P0)
3. Schedule bench E2E validation with audio fixtures (P1)
