# Test Design: Story 1.1

Date: 2025-08-19
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 10
- Unit tests: 4 (40%)
- Integration tests: 4 (40%)
- E2E tests: 2 (20%)
- Priority distribution: P0: 4, P1: 4, P2: 2

## Test Scenarios by Acceptance Criteria

### AC1: VOX starts with sustained level and includes pre‑roll

| ID           | Level       | Priority | Test                                                    | Justification                     |
| ------------ | ----------- | -------- | ------------------------------------------------------- | --------------------------------- |
| 1.1-UNIT-001 | Unit        | P0       | VOX state transitions Armed→Pre‑Roll→Recording          | Pure state machine logic          |
| 1.1-INT-001  | Integration | P0       | Pre‑roll buffer delivers expected samples to WAV writer | Interaction of buffers and writer |
| 1.1-E2E-001  | E2E         | P1       | On-device tone burst triggers recording with pre‑roll   | Critical user-visible behavior    |

### AC2: VOX stops after sustained silence and includes post‑roll

| ID           | Level       | Priority | Test                                           | Justification                    |
| ------------ | ----------- | -------- | ---------------------------------------------- | -------------------------------- |
| 1.1-UNIT-002 | Unit        | P0       | VOX stop logic with hysteresis and hold timers | Deterministic timing/state logic |
| 1.1-INT-002  | Integration | P0       | Post‑roll buffer appended correctly to WAV     | Writer integration               |
| 1.1-E2E-002  | E2E         | P1       | On-device silence after speech stops recording | Critical behavior                |

### AC3: Free space guardrail prevents start

| ID           | Level       | Priority | Test                                    | Justification         |
| ------------ | ----------- | -------- | --------------------------------------- | --------------------- |
| 1.1-UNIT-003 | Unit        | P1       | Guardrail check blocks start            | Pure decision logic   |
| 1.1-INT-003  | Integration | P1       | Storage manager reports below threshold | Component interaction |

### AC4: LED patterns reflect states

| ID           | Level | Priority | Test                                  | Justification |
| ------------ | ----- | -------- | ------------------------------------- | ------------- |
| 1.1-UNIT-004 | Unit  | P2       | UI controller maps VOX states to LEDs | Mapping logic |

### AC5: Manual override resumes arming after stop

| ID          | Level       | Priority | Test                                | Justification            |
| ----------- | ----------- | -------- | ----------------------------------- | ------------------------ |
| 1.1-INT-004 | Integration | P1       | Manual session ignores VOX triggers | Interaction/state fusion |

## Risk Coverage

- PERF-001, PERF-002 mitigated by INT/E2E SD stress and power measurements
- DATA-001 mitigated by power loss test
- BUS-001 covered by E2E noise environment tests

## Recommended Execution Order

1. P0 Unit tests (state machine, guardrail)
2. P0 Integration tests (pre/post roll to WAV)
3. P1 E2E tests (trigger/stop on device)
4. P1 Integration/UI tests
5. P2 unit tests
