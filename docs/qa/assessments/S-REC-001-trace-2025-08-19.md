# Requirements Traceability Matrix

## Story: S-REC-001 — Button-to-Record with LED and WAV

### Coverage Summary

- Total Requirements: 5 (A1–A5)
- Fully Covered: 0 (0%)
- Partially Covered: 5 (100%)
- Not Covered: 0 (0%)

planning_ref: qa.qaLocation/assessments/S-REC-001-test-design-2025-08-19.md

### Requirement Mappings

#### A1: Press within 50–300 ms begins recording

Coverage: PARTIAL

- Unit (planned):
  - Given: Debounce window 5–20 ms and tap press
  - When: BTN_DOWN/UP edges arrive with jitter
  - Then: State transitions IDLE→RECORDING within ≤300 ms
- Integration (planned):
  - Given: Recorder wired to button callback
  - When: Debounced tap
  - Then: REC_START log emitted and WAV header opened

#### A2: LED solid on during recording

Coverage: PARTIAL

- Unit (planned):
  - Given: State=RECORDING
  - When: UI updates
  - Then: LED on within 100 ms and remains on until stop
- Integration (planned):
  - Given: Start/stop sequence
  - When: REC_START/REC_STOP emitted
  - Then: LED timing from logs satisfies ≤200 ms at stop

#### A3: Second press stops recording; LED off ≤200 ms

Coverage: PARTIAL

- Unit (planned): State RECORDING→IDLE on tap; LED off within 100 ms
- Integration (planned): REC_STOP emitted; LED off latency ≤200 ms

#### A4: Valid 16 kHz mono WAV at /rec/rec_0001.wav

Coverage: PARTIAL

- Integration (planned):
  - Given: 10–60 s capture
  - When: Stop
  - Then: WAV header fields correct; nonzero data; playable on desktop
- HIL (planned):
  - Given: On-device test
  - When: Copy /rec/rec_0001.wav
  - Then: Attach to docs/qa/assessments/samples/R0_first.wav

#### A5: Survives power loss; mounts on next boot

Coverage: PARTIAL

- HIL (planned):
  - Given: Active recording
  - When: Power yank, then reboot
  - Then: SPIFFS mounts; no brick; partial file does not corrupt FS

### Gate YAML (paste into gate under `trace`)

```yaml
trace:
  totals:
    requirements: 5
    full: 0
    partial: 5
    none: 0
  planning_ref: 'qa.qaLocation/assessments/S-REC-001-test-design-2025-08-19.md'
  uncovered: []
  notes: 'See qa.qaLocation/assessments/S-REC-001-trace-2025-08-19.md'
```
